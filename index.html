<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
<title>T√¨m ch·ªØ b ‚Äì d ‚Äì ƒë (Ch·∫°m ch·ªçn)</title>

<style>
@font-face {
  font-family: "UTM Avo";
  src:
    url("fonts/utm-avo.woff2") format("woff2"),
    url("fonts/utm-avo.woff") format("woff");
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}

* {
  box-sizing: border-box;
  font-family: "UTM Avo", sans-serif;
  user-select: none;
}

body {
  margin: 0;
  background: #f5faff;
  text-align: center;
}

.top-buttons {
  position: fixed;
  top: 10px;
  right: 10px;
  display: flex;
  gap: 10px;
  z-index: 10;
}

button {
  padding: 8px 14px;
  font-size: 18px;
  border-radius: 10px;
  border: none;
  background: #4db6ac;
  color: #fff;
}

.game { margin-top: 90px; }

.card {
  margin: 10px auto;
  width: 95%;
  max-width: 520px;
}

.card img {
  width: 100%;
  max-height: 260px;
  object-fit: contain;
  cursor: pointer;
}

.word {
  font-size: 110px;
  line-height: 1.1;
  white-space: nowrap; /* gi·ªØ con ba ba 1 d√≤ng */
}

.word span {
  padding: 0 4px;
  cursor: pointer;
}

.word span.done { color: #c70414; }

.word span.active {
  border-bottom: 6px solid #00bcd4;
}

.letters {
  margin: 40px 0;
  display: flex;
  justify-content: center;
  gap: 60px;
}

.letter {
  font-size: 130px;
  color: #c70414;
  cursor: pointer;
}

.letter.selected { color: #00bcd4; }

.firework {
  position: fixed;
  width: 12px;
  height: 12px;
  background: gold;
  border-radius: 50%;
  animation: boom 0.6s ease-out forwards;
  pointer-events: none;
}

@keyframes boom {
  to { transform: scale(6); opacity: 0; }
}
</style>
</head>

<body>

<div class="top-buttons">
  <button onclick="nextCard()">Ti·∫øp theo</button>
  <button onclick="fullscreen()">‚§¢</button>
</div>

<div class="game">
  <div class="card">
    <img id="img">
    <div class="word" id="word"></div>
  </div>

  <div class="letters">
    <div class="letter" data-letter="b">b</div>
    <div class="letter" data-letter="d">d</div>
    <div class="letter" data-letter="ƒë">ƒë</div>
  </div>
</div>

<script>
const data = [
  {img:"em-be.png", text:"em b√©", target:"b", sound:"em-be.mp3"},
  {img:"ba-ba.png", text:"con ba ba", target:"b", sound:"ba-ba.mp3"},
  {img:"ban-gai.png", text:"b·∫°n g√°i", target:"b", sound:"ban-gai.mp3"},
  {img:"ca-duoi.png", text:"c√° ƒëu·ªëi", target:"ƒë", sound:"ca-duoi.mp3"},
  {img:"cay-du.png", text:"c√¢y d√π", target:"d", sound:"cay-du.mp3"},
  {img:"con-de.png", text:"con d√™", target:"d", sound:"con-de.mp3"}
];

let index = 0;
let selectedLetter = null;
let voice = null;

const img = document.getElementById("img");
const wordBox = document.getElementById("word");

/* üîä CH·∫†M V√ÄO H√åNH ‚Üí ƒê·ªåC T√äN H√åNH */
img.onclick = () => {
  const item = data[index];
  if (!item.sound) return;

  if (voice) {
    voice.pause();
    voice.currentTime = 0;
  }

  voice = new Audio("sounds/" + item.sound);
  voice.play();
};

function loadCard(){
  selectedLetter = null;
  document.querySelectorAll('.letter').forEach(l=>l.classList.remove('selected'));
  img.src = "images/" + data[index].img;
  wordBox.innerHTML = "";

  for (const ch of data[index].text) {
    if (ch === " ") {
      wordBox.append(" ");
      continue;
    }
    const s = document.createElement("span");
    s.textContent = ch;
    s.onclick = () => checkAnswer(s, ch);
    wordBox.appendChild(s);
  }
}
loadCard();

function checkAnswer(span, ch){
  if (!selectedLetter || span.classList.contains("done")) return;

  if (ch === data[index].target && selectedLetter === data[index].target) {
    span.classList.add("done");
    firework(span);
    new Audio("sounds/correct.mp3").play();
  } else {
    span.classList.add("active");
    new Audio("sounds/wrong.mp3").play();
    setTimeout(()=>span.classList.remove("active"),400);
  }
}

document.querySelectorAll(".letter").forEach(l=>{
  l.onclick = ()=>{
    document.querySelectorAll(".letter").forEach(x=>x.classList.remove("selected"));
    l.classList.add("selected");
    selectedLetter = l.dataset.letter;
  };
});

function firework(el){
  const r = el.getBoundingClientRect();
  const f = document.createElement("div");
  f.className = "firework";
  f.style.left = r.left + r.width/2 + "px";
  f.style.top = r.top + r.height/2 + "px";
  document.body.appendChild(f);
  setTimeout(()=>f.remove(),600);
}

function nextCard(){
  index = (index + 1) % data.length;
  loadCard();
}

function fullscreen(){
  !document.fullscreenElement
    ? document.documentElement.requestFullscreen()
    : document.exitFullscreen();
}
</script>

</body>
</html>
